# Минимизация плотности свободной энергии и нахождение равновесной ориентации единичного вектора намагниченности
$$f(x) \rightarrow min$$, где $$x$$ - приведённый вектор намагниченности

## Случай 1: Энергия определяется анизотропией

Рассматривается случай кубической анизотропии. 

Задача оптимизации имеет вид:  

$$f(x) = K_1 (x_1^2 x_2^2 + x_2^2 x_3^2 + x_3^2 x_1^2) + K_2 (x_1^2 x_2^2 x_3^2) \rightarrow min$$

$$x_1^2 + x_2^2 + x_3^2 = 1$$  

Где ограничение взято из соображений, что на самом деле компоненты x - это направляющие косинусы.

Таким образом, получили задачу с нелинейной функцией цели и с нелинейным ограничением-равенством.

### Основные особенности реализации:
- Используется метод SLSQP для поиска минимума.
- Добавлены границы для компонент искомого вектора $$x_i \in [-1, 1]$$, так как в такой постановке метод SLSQP работает лучше (меньше шанс отклонения от ограничений).
- Функция не является строго выпуклой, поэтому имеет несколько локальных минимумов. В зависимости от начальной точки (которая генерируется случайно), метод приходит к различным результатам.
- При некоторых сочетаниях параметров K1, K2 функция имеет скорее вогнутый вид, поэтому метод работает плохо. Исходя из этих соображений, для каждой конфигурации параметров метод запускался несколько раз (из различных начальных точек), результаты сравнивались, выбирался наилучший и предоставлялся как решение.
- Отдельно обрабатывается случай, когда есть только компонента (`K1`).

---

## Случай 2: Энергия определяется влиянием внешнего поля

Задача оптимизации имеет вид:  

$$f(x) = - M_s (x \cdot H) \rightarrow min$$

$$x_1^2 + x_2^2 + x_3^2 = 1$$  

где $$M_s = 1707 \ \frac{emu}{cc}$$ - намагниченность насыщения (значение для железа).

Это задача с линейной функцией цели и нелинейным ограничением.

### Основные особенности реализации:
- Метод оптимизации: метод проекции градиента. Метод выбран из соображения, что проецирование на область допустимых точек - единичную сферу - является несложной операцией.
- Метод использует постоянный шаг для градиентного спуска (из-за линейности функции цели).
---

## Случай 3: Энергия определяется полем размагничивания

Задача оптимизации имеет вид:  

$$f(x) = 2 \pi M_s^2 (N_{11}x_1^2 + N_{22}x_2^2 + N_{33}x_3^2) \rightarrow min$$

$$x_1^2 + x_2^2 + x_3^2 = 1$$  

где $$M_s = 1707 \ \frac{emu}{cc}$$ - намагниченность насыщения (значение для железа), 
$N_{ii}$ - факторы намагничивания ($N_{11} + N_{22} + N_{33} = 1$).

Это задача с квадратичной функцией цели и квадратичным ограничением.
Функция цели - выпуклая (но не строго!).

### Основные особенности реализации:
- Метод оптимизации: метод проекции градиента. Метод выбран из соображения, что проецирование на область допустимых точек - единичную сферу - является несложной операцией.
- Метод работает по принципу наискорейшего спуска (с помощью метода одномерной минимизации - метода золотого сечения - ищется оптимальное значение шага на каждой итерации).
---

## Замечание:
Очевидно, что в случае 1, когда $$K2 = 0$$, или когда $$K1, K2$$ имеют один знак, а также в случае 2, 3, задачу можно решить аналитически методом Лагранжа. 

## Использование
Солверы запускаются с различными конфигурациями начальных параметров.  
Полученные результаты для направлений вектора намагниченности совпадают с ожидаемыми (задача является симметричной относительно компонент искомого вектора, поэтому ответы для случая 1, являющиеся перестановками ожидаемого, верны).
