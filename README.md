# Минимизация свободной энергии и нахождение равновесной ориентации единичного вектора намагниченности
$$F(x) \rightarrow min$$, где $$x$$ - приведённый вектор намагниченности

## Случай 1: Энергия определяется анизотропией

Рассматривается случай кубической анизотропии. 

Задача оптимизации имеет вид:  

$$F(x) = K_1 (x_1^2 x_2^2 + x_2^2 x_3^2 + x_3^2 x_1^2) + K_2 (x_1^2 x_2^2 x_3^2) \rightarrow min$$

$$x_1^2 + x_2^2 + x_3^2 = 1$$  

Где ограничение взято из соображений, что на самом деле компоненты x - это направляющие косинусы.

Таким образом, получили задачу с нелинейной функцией цели и с нелинейным ограничением-равенством.

### Основные особенности реализации:
- Используется метод SLSQP для поиска минимума.
- Добавлены границы для компонент искомого вектора $$x_i \in [-1, 1]$$, так как в такой постановке метод SLSQP работает лучше (меньше шанс отклонения от ограничений)
- Функция не является строго выпуклой, поэтому имеет несколько локальных минимумов. В зависимости от начальной точки (которая генерируется случайно), метод приходит к различным результатам.
- При некоторых сочетаниях параметров K1, K2 функция имеет скорее вогнутый вид, поэтому метод работает плохо. Исходя из этих соображений, для каждой конфигурации параметров метод запускался несколько раз (из различных начальных точек), результаты сравнивались, выбирался наилучший и предоставлялся как решение.
- Отдельно обрабатывается случай, когда есть только компонента (`K1`).

---

## Случай 2: Энергия определяется влиянием внешнего поля

Задача оптимизации имеет вид:  

$$F(x) = - M_s (x \cdot H) \rightarrow min$$

$$x_1^2 + x_2^2 + x_3^2 = 1$$  


Это задача с линейной функцией цели и нелинейным ограничением.

### Основные особенности реализации:
- Метод оптимизации: метод проекции градиента. Метод выбран из соображения, что проектирование на область допустимых точек - единичную сферу - является несложной операцией.
- Метод использует постоянный шаг для градиентного спуска (из-за линейности функции цели)
---

## Замечание
Очевидно, что в случае 1, когда $$K2 = 0$$, или когда $$K1, K2$$ имеют один знак, а также в случае 2, задачу можно решить аналитически. 

## Примеры использования
Солверы запускаются с различными конфигурациями начальных параметров. Полученные результаты совпадают с ожидаемыми.
